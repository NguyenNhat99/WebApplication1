@using WebApplication1.ViewModel
@using WebApplication1.Helpers
@inject IHttpContextAccessor Http
@{
    var me = Http.HttpContext?.Session.Get<UserSessionVm>("CURRENT_USER");
    var cart = Http.HttpContext?.Session.Get<List<WebApplication1.ViewModel.CartItemVM>>("CART") ?? new();
    var cartCount = cart.Sum(x => x.Quantity);
}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - WebApplication1</title>

    <!-- Favicons -->
    <link rel="icon" href="~/assets/img/favicon.png" />
    <link rel="apple-touch-icon" href="~/assets/img/apple-touch-icon.png" />
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com" rel="preconnect" />
    <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&family=Inter:wght@100;200;300;400;500;600;700;800;900&family=Amatic+SC:wght@400;700&display=swap" rel="stylesheet" />

    <!-- Vendor CSS Files -->
    <link rel="stylesheet" href="~/assets/vendor/bootstrap/css/bootstrap.min.css" />
    <link rel="stylesheet" href="~/assets/vendor/bootstrap-icons/bootstrap-icons.css" />
    <link rel="stylesheet" href="~/assets/vendor/aos/aos.css" />
    <link rel="stylesheet" href="~/assets/vendor/glightbox/css/glightbox.min.css" />
    <link rel="stylesheet" href="~/assets/vendor/swiper/swiper-bundle.min.css" />

    <!-- Main CSS File -->
    <link rel="stylesheet" href="~/assets/css/main.css" />
   
</head>
<body>
    <header id="header" class="header d-flex align-items-center sticky-top">
        <div class="container position-relative d-flex align-items-center justify-content-between">
            <a href="@Url.Action("Index","Home")" class="logo d-flex align-items-center me-auto me-xl-0">
                <h1 class="sitename">Yummy</h1><span>.</span>
            </a>

            <nav id="navmenu" class="navmenu">
                <ul>
                    <li><a href="#hero" class="active">Home</a></li>
                    <li><a href="#menu">Menu</a></li>
                </ul>
                <i class="mobile-nav-toggle d-xl-none bi bi-list"></i>
            </nav>

            @* Nút giỏ hàng *@
            <a href="@Url.Action("Index","Cart")" class="btn btn-outline-primary position-relative me-3">
                <i class="bi bi-cart-fill fs-5"></i>
                <span id="cart-count-badge"
                      class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">
                    @cartCount
                </span>
            </a>

            @if (me == null)
            {
                <a class="btn-getstarted" href='@Url.Action("Login","Auth")'>Đăng nhập</a>
            }
            else
            {
                <form method="post" action='@Url.Action("Logout","Auth")' class="d-inline">
                    @Html.AntiForgeryToken()
                    <button type="submit" class="btn-getstarted">Đăng xuất</button>
                </form>
                if (me.Role.Equals("Admin"))
                {
                    <a href="@Url.Action("Index","Dashboard",new{area="PrivateSite"})" class="ms-2 small text-muted d-none d-md-inline">
                        Xin chào, @me.FullName
                    </a>
                }
                else
                {
                    <a href="@Url.Action("Index","Profile")" class="ms-2 small text-muted d-none d-md-inline">
                        Xin chào, @me.FullName
                    </a>
                }
               

            }
        </div>
    </header>

    @RenderBody()
    <footer id="footer" class="footer dark-background">

        <div class="container">
            <div class="row gy-3">
                <div class="col-lg-3 col-md-6 d-flex">
                    <i class="bi bi-geo-alt icon"></i>
                    <div class="address">
                        <h4>Địa chỉ</h4>
                        <p>Quận 12</p>
                        <p>Hồ Chí Minh</p>
                    </div>
                </div>

                <div class="col-lg-3 col-md-6 d-flex">
                    <i class="bi bi-telephone icon"></i>
                    <div>
                        <h4>Liên hệ</h4>
                        <p>
                            <strong>Điện thoại:</strong> <span>0942962762</span><br>
                            <strong>Email:</strong> <span>fastfood@gmail.com</span><br>
                        </p>
                    </div>
                </div>

                <div class="col-lg-3 col-md-6 d-flex">
                    <i class="bi bi-clock icon"></i>
                    <div>
                        <h4>Giờ mở cửa</h4>
                        <p>
                            <strong>Thứ 2 - Thứ 7:</strong> <span>11:00 - 23:00</span><br>
                            <strong>Chủ Nhật:</strong> <span>Đóng cửa</span>
                        </p>
                    </div>
                </div>

                <div class="col-lg-3 col-md-6">
                    <h4>Theo dõi chúng tôi</h4>
                    <div class="social-links d-flex">
                        <a href="#" class="twitter"><i class="bi bi-twitter-x"></i></a>
                        <a href="#" class="facebook"><i class="bi bi-facebook"></i></a>
                        <a href="#" class="instagram"><i class="bi bi-instagram"></i></a>
                        <a href="#" class="linkedin"><i class="bi bi-linkedin"></i></a>
                    </div>
                </div>
            </div>
        </div>

        <div class="container copyright text-center mt-4">
            <p>© <span>Bản quyền</span> <strong class="px-1 sitename">Yummy</strong> <span>Đã đăng ký mọi quyền</span></p>
        </div>

    </footer>



    <script src="~/assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="~/assets/vendor/php-email-form/validate.js"></script>
    <script src="~/assets/vendor/aos/aos.js"></script>
    <script src="~/assets/vendor/glightbox/js/glightbox.min.js"></script>
    <script src="~/assets/vendor/purecounter/purecounter_vanilla.js"></script>
    <script src="~/assets/vendor/swiper/swiper-bundle.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            AOS.init({ duration: 600, easing: 'ease-out', once: true });

            // Khởi tạo GLightbox và ép hiển thị nút Close
            const lightbox = GLightbox({
                selector: '.glightbox',
                closeButton: true,            // hiện nút Close
                closeOnOutsideClick: true,    // cho phép click ngoài để đóng
                keyboardNavigation: true
            });
        });
    </script>
    <script src="~/assets/js/main.js" asp-append-version="true" defer></script>
    @* @await RenderSectionAsync("Scripts", required: false) *@
</body>
</html>
